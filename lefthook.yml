# Lefthook - Git Hooks para Qualidade de C√≥digo
# https://github.com/evilmartians/lefthook
#
# Este arquivo configura hooks do Git para garantir qualidade de c√≥digo
# antes de commits e pushes.

# ===== HOOKS EXECUTADOS ANTES DO COMMIT =====
pre-commit:
  parallel: true
  commands:
    # ===== FORMATA√á√ÉO =====
    format:
      glob: '*.{js,jsx,ts,tsx,json,css,md,yml,yaml}'
      run: npx prettier --write {staged_files}

    # ===== LINTING =====
    lint:
      glob: '*.{js,jsx,ts,tsx}'
      run: npx eslint --fix {staged_files}

    # ===== VERIFICA√á√ÉO DE TIPOS =====
    type-check:
      glob: '*.{ts,tsx}'
      run: npx tsc --noEmit

    # ===== TESTES UNIT√ÅRIOS =====
    test:
      run: npx vitest run --reporter=verbose --run --coverage=false

# ===== HOOKS EXECUTADOS ANTES DO PUSH =====
pre-push:
  parallel: false
  commands:
    # ===== BUILD DE PRODU√á√ÉO =====
    build:
      run: npm run build

    # ===== VERIFICA√á√ÉO DE VULNERABILIDADES =====
    audit:
      run: npm audit --audit-level=moderate

    # ===== VERIFICA√á√ÉO DE QUALIDADE =====
    quality:
      run: npm run quality

    # ===== TESTES DE COBERTURA =====
    coverage:
      run: npm run test:coverage:ci

# ===== HOOKS EXECUTADOS AP√ìS O COMMIT =====
post-commit:
  commands:
    # ===== RELAT√ìRIO DE QUALIDADE =====
    quality-report:
      run: |
        echo "üéâ Commit realizado com sucesso!"
        echo "‚úÖ C√≥digo formatado e validado"
        echo "üß™ Testes executados"
        echo "üîç Depend√™ncias verificadas"
        echo "üìä Qualidade garantida"
        echo ""
        echo "üìã Pr√≥ximos passos:"
        echo "   ‚Ä¢ Execute 'npm run dev' para desenvolvimento"
        echo "   ‚Ä¢ Execute 'npm run test:coverage' para ver cobertura"
        echo "   ‚Ä¢ Execute 'npm run storybook' para documenta√ß√£o"

# ===== HOOKS EXECUTADOS AP√ìS O MERGE =====
post-merge:
  commands:
    # ===== INSTALAR DEPEND√äNCIAS =====
    install:
      run: npm install

    # ===== VERIFICAR SE TUDO EST√Å FUNCIONANDO =====
    verify:
      run: npm run quality

# ===== HOOKS EXECUTADOS AP√ìS CHECKOUT =====
post-checkout:
  commands:
    # ===== VERIFICAR DEPEND√äNCIAS =====
    check-deps:
      run: npm run deps:check

# ===== HOOKS EXECUTADOS AP√ìS REBASE =====
post-rebase:
  commands:
    # ===== REINSTALAR DEPEND√äNCIAS =====
    reinstall:
      run: npm ci

    # ===== VERIFICAR QUALIDADE =====
    quality-check:
      run: npm run quality
